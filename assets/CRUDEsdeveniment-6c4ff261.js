import{s as y}from"./utilFunctions-c00a1675.js";import{_ as S,e as o,r as s,o as E,c as I,w as n,a as l,b as r,t as h,d as U,m as F,k,f as C,F as O,i as R,j as B}from"./index-254b337e.js";const T={name:"RowEditEsde",props:{esdeveniment:Object},methods:{async saveEdit(){this.dialogEdit=!1;let a={nom:this.nom,descripcio:this.descripcio,dataIni:this.dataIni,dataFi:this.dataFi,horari:this.horari,espai:this.espai,url:this.url,latitud:this.latitud,longitud:this.longitud},e=await y("esdeveniments/"+this.esdeveniment.codi+"/","PUT",a);await this.$emit("update_esdeveniment",e)},async deleteEsdeveniment(){this.dialogDelete=!1;let a=this.esdeveniment.codi;await y("esdeveniments/"+a+"/","DELETE",""),await this.$emit("delete_esdeveniment",a)}},emits:["update_esdeveniment","delete_esdeveniment"],setup(a){let e=o(!1),u=o(!1),t=o(a.esdeveniment.nom),x=o(a.esdeveniment.descripcio),v=new Date().toISOString().slice(0,10),c=o(v);a.esdeveniment.dataIni&&(c=o(new Date(a.esdeveniment.dataIni).toISOString().slice(0,10)));let _=new Date().toISOString().slice(0,10),m=o(_);a.esdeveniment.dataFi&&(m=o(new Date(a.esdeveniment.dataFi).toISOString().slice(0,10)));let p=o(a.esdeveniment.horari),V=o(a.esdeveniment.espai),f=o(a.esdeveniment.url),b=o(a.esdeveniment.latitud),g=o(a.esdeveniment.longitud);return{dialogEdit:e,dialogDelete:u,nom:t,descripcio:x,dataIni:c,dataFi:m,horari:p,espai:V,url:f,latitud:b,longitud:g}}},j={style:{display:"flex","justify-content":"left"},class:"mt-5"},P=U("button",{class:"v-btn v-theme--light text-green",type:"submit"}," Actualitzar ",-1);function H(a,e,u,t,x,v){const c=s("v-card-title"),_=s("v-btn"),m=s("v-text-field"),p=s("v-textarea"),V=s("v-card-text"),f=s("v-spacer"),b=s("v-card-actions"),g=s("v-card"),w=s("v-dialog"),D=s("v-row");return E(),I(g,{class:"my-5 mx-10"},{default:n(()=>[l(D,{justify:"space-between",style:{height:"75px"}},{default:n(()=>[l(c,null,{default:n(()=>[r(h(u.esdeveniment.nom),1)]),_:1}),U("div",j,[l(w,{modelValue:t.dialogEdit,"onUpdate:modelValue":e[11]||(e[11]=d=>t.dialogEdit=d),persistent:"","max-width":"100%"},{activator:n(({props:d})=>[l(_,F(d,{color:"#2eca5a",class:"mr-5"}),{default:n(()=>[r("Modificar")]),_:2},1040)]),default:n(()=>[l(g,null,{default:n(()=>[U("form",{onSubmit:e[10]||(e[10]=k(d=>v.saveEdit(),["prevent"]))},[l(c,{class:"text-h5"},{default:n(()=>[r(" Edició de "+h(u.esdeveniment.nom),1)]),_:1}),l(V,null,{default:n(()=>[l(m,{modelValue:t.nom,"onUpdate:modelValue":e[0]||(e[0]=d=>t.nom=d),label:"Nom",required:""},null,8,["modelValue"]),l(p,{modelValue:t.descripcio,"onUpdate:modelValue":e[1]||(e[1]=d=>t.descripcio=d),label:"Descripció"},null,8,["modelValue"]),l(m,{modelValue:t.dataIni,"onUpdate:modelValue":e[2]||(e[2]=d=>t.dataIni=d),label:"Data d'inici",type:"date",required:""},null,8,["modelValue"]),l(m,{modelValue:t.dataFi,"onUpdate:modelValue":e[3]||(e[3]=d=>t.dataFi=d),label:"Data de final",type:"date",required:""},null,8,["modelValue"]),l(p,{modelValue:t.horari,"onUpdate:modelValue":e[4]||(e[4]=d=>t.horari=d),label:"Horari"},null,8,["modelValue"]),l(m,{modelValue:t.espai,"onUpdate:modelValue":e[5]||(e[5]=d=>t.espai=d),label:"Espai"},null,8,["modelValue"]),l(m,{modelValue:t.url,"onUpdate:modelValue":e[6]||(e[6]=d=>t.url=d),label:"Enllaç a l'esdeveniment",type:"text",pattern:"https?://.+"},null,8,["modelValue"]),l(m,{modelValue:t.latitud,"onUpdate:modelValue":e[7]||(e[7]=d=>t.latitud=d),label:"Latitud",type:"number",step:"0.1"},null,8,["modelValue"]),l(m,{modelValue:t.longitud,"onUpdate:modelValue":e[8]||(e[8]=d=>t.longitud=d),label:"Longitud",type:"number",step:"0.1"},null,8,["modelValue"])]),_:1}),l(b,null,{default:n(()=>[l(f),l(_,{color:"red",onClick:e[9]||(e[9]=d=>t.dialogEdit=!1)},{default:n(()=>[r(" Cancel·lar ")]),_:1}),P]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),l(w,{modelValue:t.dialogDelete,"onUpdate:modelValue":e[14]||(e[14]=d=>t.dialogDelete=d),persistent:"",width:"auto"},{activator:n(({props:d})=>[l(_,F(d,{color:"red",class:"mr-8"}),{default:n(()=>[r("Esborrar")]),_:2},1040)]),default:n(()=>[l(g,null,{default:n(()=>[l(c,{class:"text-h5"},{default:n(()=>[r(" Segur que vols aquest esdeveniment? ")]),_:1}),l(V,null,{default:n(()=>[r(" Si elimines l'esdeveniment no el podràs recuperar, i deixarà d'estar disponible per a la ciutadania. ")]),_:1}),l(b,null,{default:n(()=>[l(f),l(_,{color:"green",onClick:e[12]||(e[12]=d=>t.dialogDelete=!1)},{default:n(()=>[r(" NO ")]),_:1}),l(_,{color:"red",onClick:e[13]||(e[13]=d=>v.deleteEsdeveniment())},{default:n(()=>[r(" SÍ ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})}const M=S(T,[["render",H]]),z={name:"CRUDEsdeveniment",components:{RowEditEsde:M},computed:{esdevenimentsFiltrats(){return this.esdeveniments.filter(a=>a.nom.toLowerCase().includes(this.buscar.toLowerCase()))}},setup(){let a=o(),e=o(""),u=o(!1),t=o(""),x=o(),v=o(),c=o(),_=o(),m=o(),p=o(),V=o(),f=o();return{esdeveniments:a,buscar:e,dialogAdd:u,nom:t,descripcio:x,dataIni:v,dataFi:c,horari:_,espai:m,url:p,latitud:V,longitud:f}},methods:{update_esdeveniment(a){const e=this.esdeveniments.findIndex(u=>u.codi===a.codi);this.esdeveniments.splice(e,1,a)},delete_esdeveniment(a){const e=this.esdeveniments.findIndex(u=>u.codi===a);this.esdeveniments.splice(e,1)},async addEsdeveniment(){this.dialogAdd=!1,console.log("sha creat un esdeveniment");let a={nom:this.nom,descripcio:this.descripcio,dataIni:this.dataIni,dataFi:this.dataFi,horari:this.horari,espai:this.espai,url:this.url,latitud:this.latitud,longitud:this.longitud};await y("esdeveniments/","POST",a).then(e=>this.esdeveniments.unshift(e))}},mounted(){y("esdeveniments/","GET","").then(a=>this.esdeveniments=a)}},G={key:0},J=U("button",{class:"v-btn v-theme--light text-green",type:"submit"}," Crear ",-1);function K(a,e,u,t,x,v){const c=s("v-app-bar-title"),_=s("v-app-bar"),m=s("v-text-field"),p=s("v-btn"),V=s("v-card-title"),f=s("v-textarea"),b=s("v-card-text"),g=s("v-spacer"),w=s("v-card-actions"),D=s("v-card"),d=s("v-dialog"),q=s("v-row"),L=s("RowEditEsde"),A=s("v-app");return E(),I(A,null,{default:n(()=>[l(_,null,{default:n(()=>[l(c,null,{default:n(()=>[r(" Crear i gestionar esdeveniments ")]),_:1})]),_:1}),t.esdeveniments?(E(),C("div",G,[l(q,{class:"mt-8 mx- 5"},{default:n(()=>[l(m,{modelValue:t.buscar,"onUpdate:modelValue":e[0]||(e[0]=i=>t.buscar=i),label:"Buscar",class:"mt-5 ml-5 mr-14"},null,8,["modelValue"]),l(d,{modelValue:t.dialogAdd,"onUpdate:modelValue":e[12]||(e[12]=i=>t.dialogAdd=i),persistent:"","max-width":"100%"},{activator:n(({props:i})=>[l(p,F(i,{class:"mr-10 mt-7"}),{default:n(()=>[r("ADD")]),_:2},1040)]),default:n(()=>[l(D,null,{default:n(()=>[U("form",{onSubmit:e[11]||(e[11]=k(i=>v.addEsdeveniment(),["prevent"]))},[l(V,{class:"text-h5"},{default:n(()=>[r(" Registrar un nou esdeveniment ")]),_:1}),l(b,null,{default:n(()=>[l(m,{modelValue:t.nom,"onUpdate:modelValue":e[1]||(e[1]=i=>t.nom=i),label:"Nom",type:"text",required:""},null,8,["modelValue"]),l(f,{modelValue:t.descripcio,"onUpdate:modelValue":e[2]||(e[2]=i=>t.descripcio=i),label:"Descripció"},null,8,["modelValue"]),l(m,{modelValue:t.dataIni,"onUpdate:modelValue":e[3]||(e[3]=i=>t.dataIni=i),label:"Data d'inici",type:"date",required:""},null,8,["modelValue"]),l(m,{modelValue:t.dataFi,"onUpdate:modelValue":e[4]||(e[4]=i=>t.dataFi=i),label:"Data de final",type:"date",required:""},null,8,["modelValue"]),l(f,{modelValue:t.horari,"onUpdate:modelValue":e[5]||(e[5]=i=>t.horari=i),label:"Horari"},null,8,["modelValue"]),l(m,{modelValue:t.espai,"onUpdate:modelValue":e[6]||(e[6]=i=>t.espai=i),label:"Espai"},null,8,["modelValue"]),l(m,{modelValue:t.url,"onUpdate:modelValue":e[7]||(e[7]=i=>t.url=i),label:"Enllaç a l'esdeveniment",type:"text",pattern:"https?://.+"},null,8,["modelValue"]),l(m,{modelValue:t.latitud,"onUpdate:modelValue":e[8]||(e[8]=i=>t.latitud=i),label:"Latitud",type:"number",step:"0.1"},null,8,["modelValue"]),l(m,{modelValue:t.longitud,"onUpdate:modelValue":e[9]||(e[9]=i=>t.longitud=i),label:"Longitud",type:"number",step:"0.1"},null,8,["modelValue"])]),_:1}),l(w,null,{default:n(()=>[l(g),l(p,{color:"red",onClick:e[10]||(e[10]=i=>t.dialogAdd=!1)},{default:n(()=>[r(" Cancel·lar ")]),_:1}),J]),_:1})],32)]),_:1})]),_:1},8,["modelValue"])]),_:1}),(E(!0),C(O,null,R(v.esdevenimentsFiltrats,(i,N)=>(E(),I(L,{key:N,esdeveniment:i,onUpdate_esdeveniment:v.update_esdeveniment,onDelete_esdeveniment:v.delete_esdeveniment},null,8,["esdeveniment","onUpdate_esdeveniment","onDelete_esdeveniment"]))),128))])):B("",!0)]),_:1})}const X=S(z,[["render",K]]);export{X as default};
