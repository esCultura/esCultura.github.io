import{s as y}from"./utilFunctions-c00a1675.js";import{_ as S,e as o,r as s,o as w,c as C,w as a,a as l,b as v,t as F,d as E,m as I,k,f as h,F as L,i as A,j as N}from"./index-10d64fce.js";const O={name:"RowEditEsde",props:{esdeveniment:Object},methods:{async saveEdit(){this.dialogEdit=!1;let n={nom:this.nom,descripcio:this.descripcio,dataIni:this.dataIni,dataFi:this.dataFi,horari:this.horari,espai:this.espai,url:this.url,latitud:this.latitud,longitud:this.longitud},e=await y("esdeveniments/"+this.esdeveniment.codi+"/","PUT",n);await this.$emit("update_esdeveniment",e)},async deleteEsdeveniment(){this.dialogDelete=!1;let n=this.esdeveniment.codi;await y("esdeveniments/"+n+"/","DELETE",""),await this.$emit("delete_esdeveniment",n)}},emits:["update_esdeveniment","delete_esdeveniment"],setup(n){let e=o(!1),c=o(!1),t=o(n.esdeveniment.nom),x=o(n.esdeveniment.descripcio),_=new Date().toISOString().slice(0,10),m=o(_);n.esdeveniment.dataIni&&(m=o(new Date(n.esdeveniment.dataIni).toISOString().slice(0,10)));let u=new Date().toISOString().slice(0,10),r=o(u);n.esdeveniment.dataFi&&(r=o(new Date(n.esdeveniment.dataFi).toISOString().slice(0,10)));let V=o(n.esdeveniment.horari),f=o(n.esdeveniment.espai),p=o(n.esdeveniment.url),b=o(n.esdeveniment.latitud),g=o(n.esdeveniment.longitud);return{dialogEdit:e,dialogDelete:c,nom:t,descripcio:x,dataIni:m,dataFi:r,horari:V,espai:f,url:p,latitud:b,longitud:g}}},R={style:{display:"flex","justify-content":"left"},class:"mt-5"},B=E("button",{class:"v-btn v-theme--light text-green",type:"submit"}," Actualitzar ",-1);function T(n,e,c,t,x,_){const m=s("v-card-title"),u=s("v-btn"),r=s("v-text-field"),V=s("v-textarea"),f=s("v-card-text"),p=s("v-spacer"),b=s("v-card-actions"),g=s("v-card"),U=s("v-dialog"),D=s("v-row");return w(),C(g,{class:"my-5 mx-10"},{default:a(()=>[l(D,{justify:"space-between",style:{height:"75px"}},{default:a(()=>[l(m,null,{default:a(()=>[v(F(c.esdeveniment.nom),1)]),_:1}),E("div",R,[l(U,{modelValue:t.dialogEdit,"onUpdate:modelValue":e[11]||(e[11]=d=>t.dialogEdit=d),persistent:"","max-width":"100%"},{activator:a(({props:d})=>[l(u,I(d,{color:"#2eca5a",class:"mr-5"}),{default:a(()=>[v("Modificar")]),_:2},1040)]),default:a(()=>[l(g,null,{default:a(()=>[E("form",{onSubmit:e[10]||(e[10]=k(d=>_.saveEdit(),["prevent"]))},[l(m,{class:"text-h5"},{default:a(()=>[v(" Edició de "+F(c.esdeveniment.nom),1)]),_:1}),l(f,null,{default:a(()=>[l(r,{modelValue:t.nom,"onUpdate:modelValue":e[0]||(e[0]=d=>t.nom=d),label:"Nom",required:""},null,8,["modelValue"]),l(V,{modelValue:t.descripcio,"onUpdate:modelValue":e[1]||(e[1]=d=>t.descripcio=d),label:"Descripció"},null,8,["modelValue"]),l(r,{modelValue:t.dataIni,"onUpdate:modelValue":e[2]||(e[2]=d=>t.dataIni=d),label:"Data d'inici",type:"date",required:""},null,8,["modelValue"]),l(r,{modelValue:t.dataFi,"onUpdate:modelValue":e[3]||(e[3]=d=>t.dataFi=d),label:"Data de final",type:"date",required:""},null,8,["modelValue"]),l(V,{modelValue:t.horari,"onUpdate:modelValue":e[4]||(e[4]=d=>t.horari=d),label:"Horari"},null,8,["modelValue"]),l(r,{modelValue:t.espai,"onUpdate:modelValue":e[5]||(e[5]=d=>t.espai=d),label:"Espai"},null,8,["modelValue"]),l(r,{modelValue:t.url,"onUpdate:modelValue":e[6]||(e[6]=d=>t.url=d),label:"Enllaç a l'esdeveniment",type:"text",pattern:"https?://.+"},null,8,["modelValue"]),l(r,{modelValue:t.latitud,"onUpdate:modelValue":e[7]||(e[7]=d=>t.latitud=d),label:"Latitud",type:"number",step:"0.1"},null,8,["modelValue"]),l(r,{modelValue:t.longitud,"onUpdate:modelValue":e[8]||(e[8]=d=>t.longitud=d),label:"Longitud",type:"number",step:"0.1"},null,8,["modelValue"])]),_:1}),l(b,null,{default:a(()=>[l(p),l(u,{color:"red",onClick:e[9]||(e[9]=d=>t.dialogEdit=!1)},{default:a(()=>[v(" Cancel·lar ")]),_:1}),B]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),l(U,{modelValue:t.dialogDelete,"onUpdate:modelValue":e[14]||(e[14]=d=>t.dialogDelete=d),persistent:"",width:"auto"},{activator:a(({props:d})=>[l(u,I(d,{color:"red",class:"mr-8"}),{default:a(()=>[v("Esborrar")]),_:2},1040)]),default:a(()=>[l(g,null,{default:a(()=>[l(m,{class:"text-h5"},{default:a(()=>[v(" Segur que vols aquest esdeveniment? ")]),_:1}),l(f,null,{default:a(()=>[v(" Si elimines l'esdeveniment no el podràs recuperar, i deixarà d'estar disponible per a la ciutadania. ")]),_:1}),l(b,null,{default:a(()=>[l(p),l(u,{color:"green",onClick:e[12]||(e[12]=d=>t.dialogDelete=!1)},{default:a(()=>[v(" NO ")]),_:1}),l(u,{color:"red",onClick:e[13]||(e[13]=d=>_.deleteEsdeveniment())},{default:a(()=>[v(" SÍ ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})}const j=S(O,[["render",T]]),P={name:"CRUDEsdeveniment",components:{RowEditEsde:j},computed:{esdevenimentsFiltrats(){return this.esdeveniments.filter(n=>n.nom.toLowerCase().includes(this.buscar.toLowerCase()))}},setup(){let n=o(),e=o(""),c=o(!1),t=o(""),x=o(),_=o(),m=o(),u=o(),r=o(),V=o(),f=o(),p=o();return{esdeveniments:n,buscar:e,dialogAdd:c,nom:t,descripcio:x,dataIni:_,dataFi:m,horari:u,espai:r,url:V,latitud:f,longitud:p}},methods:{update_esdeveniment(n){const e=this.esdeveniments.findIndex(c=>c.codi===n.codi);this.esdeveniments.splice(e,1,n)},delete_esdeveniment(n){const e=this.esdeveniments.findIndex(c=>c.codi===n);this.esdeveniments.splice(e,1)},async addEsdeveniment(){this.dialogAdd=!1,console.log("sha creat un esdeveniment");let n={nom:this.nom,descripcio:this.descripcio,dataIni:this.dataIni,dataFi:this.dataFi,horari:this.horari,espai:this.espai,url:this.url,latitud:this.latitud,longitud:this.longitud};await y("esdeveniments/","POST",n).then(e=>this.esdeveniments.unshift(e))}},mounted(){y("esdeveniments/","GET","").then(n=>this.esdeveniments=n)}},H={key:0},M=E("button",{class:"v-btn v-theme--light text-green",type:"submit"}," Crear ",-1);function z(n,e,c,t,x,_){const m=s("v-text-field"),u=s("v-btn"),r=s("v-card-title"),V=s("v-textarea"),f=s("v-card-text"),p=s("v-spacer"),b=s("v-card-actions"),g=s("v-card"),U=s("v-dialog"),D=s("v-row"),d=s("RowEditEsde");return t.esdeveniments?(w(),h("div",H,[l(D,{class:"mt-8 mx- 5"},{default:a(()=>[l(m,{modelValue:t.buscar,"onUpdate:modelValue":e[0]||(e[0]=i=>t.buscar=i),label:"Buscar",class:"mt-5 ml-5 mr-14"},null,8,["modelValue"]),l(U,{modelValue:t.dialogAdd,"onUpdate:modelValue":e[12]||(e[12]=i=>t.dialogAdd=i),persistent:"","max-width":"100%"},{activator:a(({props:i})=>[l(u,I(i,{class:"mr-10 mt-7"}),{default:a(()=>[v("ADD")]),_:2},1040)]),default:a(()=>[l(g,null,{default:a(()=>[E("form",{onSubmit:e[11]||(e[11]=k(i=>_.addEsdeveniment(),["prevent"]))},[l(r,{class:"text-h5"},{default:a(()=>[v(" Registrar un nou esdeveniment ")]),_:1}),l(f,null,{default:a(()=>[l(m,{modelValue:t.nom,"onUpdate:modelValue":e[1]||(e[1]=i=>t.nom=i),label:"Nom",type:"text",required:""},null,8,["modelValue"]),l(V,{modelValue:t.descripcio,"onUpdate:modelValue":e[2]||(e[2]=i=>t.descripcio=i),label:"Descripció"},null,8,["modelValue"]),l(m,{modelValue:t.dataIni,"onUpdate:modelValue":e[3]||(e[3]=i=>t.dataIni=i),label:"Data d'inici",type:"date",required:""},null,8,["modelValue"]),l(m,{modelValue:t.dataFi,"onUpdate:modelValue":e[4]||(e[4]=i=>t.dataFi=i),label:"Data de final",type:"date",required:""},null,8,["modelValue"]),l(V,{modelValue:t.horari,"onUpdate:modelValue":e[5]||(e[5]=i=>t.horari=i),label:"Horari"},null,8,["modelValue"]),l(m,{modelValue:t.espai,"onUpdate:modelValue":e[6]||(e[6]=i=>t.espai=i),label:"Espai"},null,8,["modelValue"]),l(m,{modelValue:t.url,"onUpdate:modelValue":e[7]||(e[7]=i=>t.url=i),label:"Enllaç a l'esdeveniment",type:"text",pattern:"https?://.+"},null,8,["modelValue"]),l(m,{modelValue:t.latitud,"onUpdate:modelValue":e[8]||(e[8]=i=>t.latitud=i),label:"Latitud",type:"number",step:"0.1"},null,8,["modelValue"]),l(m,{modelValue:t.longitud,"onUpdate:modelValue":e[9]||(e[9]=i=>t.longitud=i),label:"Longitud",type:"number",step:"0.1"},null,8,["modelValue"])]),_:1}),l(b,null,{default:a(()=>[l(p),l(u,{color:"red",onClick:e[10]||(e[10]=i=>t.dialogAdd=!1)},{default:a(()=>[v(" Cancel·lar ")]),_:1}),M]),_:1})],32)]),_:1})]),_:1},8,["modelValue"])]),_:1}),(w(!0),h(L,null,A(_.esdevenimentsFiltrats,(i,q)=>(w(),C(d,{key:q,esdeveniment:i,onUpdate_esdeveniment:_.update_esdeveniment,onDelete_esdeveniment:_.delete_esdeveniment},null,8,["esdeveniment","onUpdate_esdeveniment","onDelete_esdeveniment"]))),128))])):N("",!0)}const K=S(P,[["render",z]]);export{K as default};
